#!/bin/bash

algo="lssimple"
t=120;
data=(
        "a05100" "a10100" "a20100" "a05200" "a10200" "a20200" \
        "b05100" "b10100" "b20100" "b05200" "b10200" "b20200" \
        "c05100" "c10100" "c20100" "c10400" "c05200" "c10200" "c20200" "c20400" \
        "c40400" "c15900" "c30900" "c60900" "c201600" "c401600" "c801600" \
        "d05100" "d10100" "d20100" "d10400" "d05200" "d10200" "d20200" "d20400" \
        "d40400" "d15900" "d30900" "d60900" "d201600" "d401600" "d801600" \
        "e05100" "e10100" "e20100" "e10400" "e05200" "e10200" "e20200" "e20400" \
        "e40400" "e15900" "e30900" "e60900" "e201600" "e401600" "e801600" \
)

bazel build --cxxopt='-std=c++14' --compilation_mode=opt -- //lib:main
for i in "${data[@]}"; do
    certfile="solutions_${algo}_${t}/${i}_solution.txt"
     inifile="solutions_${algo}_${t}/${i}_output.ini"
    echo -n "${i},"
    ./bazel-bin/lib/main \
        -a "${algo}" \
        -t "${t}" \
        -i "data/${i}" \
        -c ${certfile} \
        -o ${inifile}
    sed -nr "/^\[Solution\]/ { :l /^Value[ ]*=/ { s/.*=[ ]*//; p; q;}; n; b l;}" "${inifile}"
done

